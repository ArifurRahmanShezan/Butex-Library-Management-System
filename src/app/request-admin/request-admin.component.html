<h2>Library Request Administration</h2>

<table>
  <thead>
    <tr>
      <th>#</th>
      <th>Title</th>
      <th>Author</th>
      <th>Requester</th>
      <th>Email</th>
      <th>Department</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let req of requests; let i = index">
      <td>{{ i + 1 }}</td>
      <td>{{ req.title }}</td>
      <td>{{ req.author }}</td>
      <td>{{ req.requesterName }}</td>
      <td>{{ req.requesterEmail }}</td>
      <td>{{ req.department }}</td>
      <td>{{ req.status || 'PENDING' }}</td>
      <td>
        <button class="btn-primary" (click)="openModal(req.id)">Update Status</button>
      </td>
    </tr>
  </tbody>
</table>

<!-- Modal -->
<div id="modal" [class.show]="showModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Update Request Status</h3>
      <span class="close-btn" (click)="closeModal()">Ã—</span>
    </div>

    <form [formGroup]="statusForm" (ngSubmit)="onSubmitStatus()">
      <label>Status</label>
      <select formControlName="status">
        <option value="">Select Status</option>
        <option value="APPROVED">APPROVED</option>
        <option value="REJECTED">REJECTED</option>
        <option value="PENDING">PENDING</option>
      </select>

      <label>Justification</label>
      <textarea formControlName="justification" placeholder="Provide reason or note"></textarea>

      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="closeModal()">Cancel</button>
        <button type="submit" class="btn-success" [disabled]="isSubmitting || statusForm.invalid">
          {{ isSubmitting ? 'Updating...' : 'Save Changes' }}
        </button>
      </div>
    </form>
  </div>
</div>
